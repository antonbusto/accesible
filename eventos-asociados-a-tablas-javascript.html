<!DOCTYPE html>
<html lang="es">
   <head>
      <meta charset="UTF-8">
      <title>Productos de supermercado con progamación javascript</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="author" content="Antonio José Busto">
      <style>
         html {
         font-size: 16px;
         }
         /* modo claro */
         body { 
         padding: 20px;
         background-color: white;
         color: black;
         font-family: Arial, Helvetica, sans;
         font-size: 1.1rem;
         }
         table, caption {
         margin: 1rem;
         }
         table, th, td {
         border: 1px solid;
         }
         button, table, th, td {
         padding: 5px;
         }
         /* modo oscuro */
         .modo-oscuro {
         background-color:  #666666; /* rgb(112,128,144); */
         color: white;
         }
      </style>
   </head>
   <body>
      <!-- debemos utilizar HTML 5 semántico -->
      <header>
         <h1>Productos de supermercado</h1>
      </header>
      <nav>
	  <!-- se ha añadido la propiedad tabindex a las zonas importantes -->
         <button onclick="modoOscuro()" role="button" tabindex="1">Alternar modo oscuro</button>
      </nav>
      <main>
         <article id= "contenido">
            <h2 tabindex="2">Tabla Comparativa de productos</h2>
            <table id="tabla">
               <!-- caption responderá con el controlador on con los eventos de ratón mousedown y mouseup -->         
               <caption tabindex="3" onmousedown="cambiarColor(this,'orange')" onmouseup="cambiarColor(this,'green')">Tabla con diferentes productos de supermercado, incluyendo precio, imágenes de los productos y enlaces al supermercado on-line.</caption>
               <thead>
                  <tr tabindex="4">
                <!-- alternativa, podríamos usar scope="col" en lugar de id -->
                     <th id="producto">Producto</th>
                     <th id="categoria">Categoría</th>
                     <th id="precio">Precio</th>
                     <th id="imagen">Imagen</th>
                     <th id="enlace">Enlace</th>
                  </tr>
               </thead>
               <tbody>
                  <tr tabindex="5">
                     <td headers="producto">Detergente</td>
                     <td headers="categoria">Limpieza</td>
                     <td headers="precio">11,89</td>
                     <td headers="imagen"><img src="img/detergente.png" alt="Foto del detergente"></td>
                     <td headers="enlace"><a href="https://supermercado.eroski.es">Detergente en Eroski</a>
                     </td>
                  </tr>
                  <tr tabindex="6">
                     <td headers="producto">Garbanzos</td>
                     <td headers="categoria">Alimentación</td>
                     <td headers="precio">3,80</td>
                     <td headers="imagen"><img src="img/garbanzos.png" alt="Foto de los garbanzos"></td>
                     <td headers="enlace"><a href="https://supermercado.eroski.es">Garbanzos en Eroski</a></td>
                  </tr>
                  <tr tabindex="7">
                     <td headers="producto">Cerveza</td>
                     <td headers="categoria">Bebidas</td>
                     <td headers="precio">0,79</td>
                     <td headers="imagen"><img src="img/cerveza.png" alt="Foto de la cerveza"></td>
                     <td headers="enlace"><a href="https://supermercado.eroski.es">Cerveza en Eroski</a></td>
                  </tr>
               </tbody>
            </table>
         </article>
      </main>
      <script defer> // defer para esperar la carga del DOM
         // declaración y asignación de variable utilizando DOM
         let tabla = document.querySelector("table");
         
         // función para diferenciar los eventos click y doble click
         function eventos() {
         let retraso = 400, clicks = 0, tiempo = null;
         tabla.addEventListener("click", function(e) {
                 clicks++;  // contar clics
                 if(clicks === 1) { // si click es exactamente 1
				 // utilizo un temporizador
                     tiempo = setTimeout(function() {
                         alert("Has hecho Click con el botón izquierdo"); //realizar acción de un solo clic
                         clicks = 0;  //después de realizar la acción, restablecer el contador
                     }, retraso);
                 } else { // si click es mayor de 1
                     clearTimeout(tiempo); //prevenir la acción de un solo clic
                     alert("Has hecho Doble Click con el botón izquierdo"); //realizar la acción de doble clic
                     clicks = 0; //después de realizar la acción, restablecer el contador
                 }
             });	
             tabla.addEventListener("dblclick", function(e){
                 e.preventDefault();  //después de realizar la acción, restablecer el contador
             });
         }
         // permanecer a la escucha del evento menú contextual
         tabla.addEventListener("contextmenu", function(e) {
         	alert("Has hecho Click en el botón derecho");
         	e.preventDefault(); // evitar la aparición del menú contextual
         	/* también podría especificar el evento con: evento = e.type; alert(evento); */
         });
         
         // La siguiente función se invoca con el controlador on para los eventos mousedown y mouseup, permite cambiar el color del texto del caption de la tabla
         function cambiarColor(e, color) {
           e.style.color = color;
		   alert("El texto de caption cambiará a naranja. Evento: mouseup")
         }
         
         //función para mejorar la accesibilidad con modo oscuro con CSS
             function modoOscuro() {
         		let todo = document.body; // afecta a todo el body
         		todo.classList.toggle("modo-oscuro");
         	}	
			
         eventos(); // invocar a la función de control de cliks 
      </script>
      <p>La programación trata los eventos click, dobleclik, contextmenu (botón derecho), mousedown y mouseup en la tabla</p>
      <footer>
         <p>Tabla accesible con programación de eventos de JavaScript</p>
      </footer>
   </body>
</html>